<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="/libs/lunr/lunr.min.js"></script>
<script src="/libs/lunr/lunr_index.js"></script>
<script src="/libs/lunr/lunrclient.min.js"></script>
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/poole_hyde.css">
<link rel="stylesheet" href="/css/custom.css">
<!-- style adjustments -->
<style>
  html {font-size: 17px;}
  .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;}
  @media (min-width: 940px) {
    .franklin-content {width: 100%; margin-left: auto; margin-right: auto;}
  }
  @media (max-width: 768px) {
    .franklin-content {padding-left: 6%; padding-right: 6%;}
  }
</style>

<link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">



   <title>Linear Elasticity Tutorial</title>  
</head>
<style>
.content {max-width: 60rem}
</style>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="/assets/logos.png" style="width: 500px; height: auto; display: inline">
      <div style="font-weight: margin-bottom: 0.5em"><a href="/">28-29th, November, 2023</a> <span style="opacity: 0.9;">| Australian National University, Canberra</span></div>
      <br>
      <h1><a href="/">Introduction to Gridap: Simulating PDEs using finite elements in Julia</a></h1>
      <div style="line-height:18px; font-size: 15px; opacity: 0.85">by &nbsp; <a href="https://research.monash.edu/en/persons/santiago-badia">Santiago Badia</a>, &nbsp; <a href="https://amartinhuertas.github.io/">Alberto F. Martin</a>, &nbsp; <a href="https://github.com/JordiManyer">Jordi Manyer</a> </div>
    </div>
    <br>
    <style>
    </style>
    <nav class="sidebar-nav" style="opacity: 0.9; margin-bottom: 1.2cm;">
      <a class="sidebar-nav-item " href="/"><b>Welcome</b></a>
      <a class="sidebar-nav-item " href="/venue/"><b>Venue</b></a>
      <a class="sidebar-nav-item " href="/schedule"><b>Schedule</b></a>
      <a class="sidebar-nav-item " href="/software_install/">Software install instructions</a>
      <a class="sidebar-nav-item " href="/tutorials/">Tutorials & Exercises</a>
      <a class="sidebar-nav-item " href="/references/">References</a>
      <a class="sidebar-nav-item " href="/grants/">Registration and
               grants for research students</a>
      <a class="sidebar-nav-item " href="/acks/">Acknowledgements</a>         
      <a class="sidebar-nav-item " href="/flyer/">Event Flyer</a>
      <br>
    </nav>
    <form id="lunrSearchForm" name="lunrSearchForm">
      <input class="search-input" name="q" placeholder="Enter search term" type="text">
      <input type="submit" value="Search" formaction="/search/index.html">
    </form>
    <br>
    <br>
  </div>
</div>
<div class="content container">

<!-- Content appended here -->
<div class="franklin-content">
<h1 id="linear_elasticity_tutorial"><a href="#linear_elasticity_tutorial" class="header-anchor">Linear Elasticity Tutorial</a></h1>
<h2 id="problem_statement"><a href="#problem_statement" class="header-anchor">Problem statement</a></h2>
<p>We want to solve a linear elasticity problem defined on the 3D domain depicted in next figure.</p>
<p><img src="/assets/literate_figures/elasticity/solid.png" alt="" /></p>
<p>We impose the following boundary conditions. All components of the displacement vector are constrained to zero on the surface \(\Gamma_{\rm G}\), which is marked in green in the figure. On the other hand, the first component of the displacement vector is prescribed to the value \(\delta\doteq 5\)mm on the surface \(\Gamma_{\rm B}\), which is marked in blue. No body or surface forces are included in this example. Formally, the PDE to solve is</p>
\[
\left\lbrace
\begin{aligned}
-∇\cdot\sigma(u) = 0 \ &\text{ in } \ \Omega,\\
u = 0 \ &\text{ on }\ \Gamma_{\rm G},\\
u_1 = \delta \ &\text{ on }\ \Gamma_{\rm B},\\
n \cdot \sigma(u)  = 0 \ &\text{ on }\  \Gamma_{\rm N}.\\
\end{aligned}
\right.
\]
<p>The variable \(u\) stands for the unknown displacement vector, the vector \(n\) is the unit outward normal to the Neumann boundary \(\Gamma_{\rm N}\doteq\partial\Omega\setminus\left(\Gamma_{\rm B}\cup\Gamma_{\rm G}\right)\) and \(\sigma(u)\) is the stress tensor defined as</p>
\[
\sigma(u) \doteq \lambda\ {\rm tr}(\varepsilon(u)) \ I +2 \mu \  \varepsilon(u),
\]
<p>where \(I\) is the 2nd order identity tensor, and \(\lambda\) and \(\mu\) are the <em>Lamé parameters</em> of the material. The operator \(\varepsilon(u)\doteq\frac{1}{2}\left(\nabla u + (\nabla u)^T \right)\) is the symmetric gradient operator &#40;i.e., the strain tensor&#41;. Here, we consider material parameters corresponding to aluminum with Young&#39;s modulus \(E=70\cdot 10^9\) Pa and Poisson&#39;s ratio \(\nu=0.33\). From these values, the Lamé parameters are obtained as \(\lambda = (E\nu)/((1+\nu)(1-2\nu))\) and \(\mu=E/(2(1+\nu))\).</p>
<h2 id="numerical_scheme"><a href="#numerical_scheme" class="header-anchor">Numerical scheme</a></h2>
<p>We use a conventional Galerkin FE method with conforming Lagrangian FE spaces. For this formulation, the weak form is: find \(u\in U\) such that \( a(u,v) = 0 \) for all \(v\in V_0\), where \(U\) is the subset of functions in \(V\doteq[H^1(\Omega)]^3\) that fulfill the Dirichlet boundary conditions of the problem, whereas \(V_0\) are functions in \(V\) fulfilling \(v=0\) on \(\Gamma_{\rm G}\) and \(v_1=0\) on \(\Gamma_{\rm B}\). The bilinear form of the problem is</p>
\[
a(u,v)\doteq \int_{\Omega} \varepsilon(v) : \sigma(u) \ {\rm d}\Omega.
\]
<h2 id="load_and_inspect_the_discrete_model"><a href="#load_and_inspect_the_discrete_model" class="header-anchor">Load and inspect the discrete model</a></h2>
<p>On top of it&#39;s mesh-generation functionalities, Gridap provides a convenient ways to read and write discrete models from and to files. We import the model for this problem from <code>GMSH</code> as follows:</p>
<pre><code class="language-julia">using Gridap, GridapGmsh
using DrWatson

msh_file_gmsh &#61; projectdir&#40;&quot;meshes/elasticity.msh&quot;&#41;
model &#61; GmshDiscreteModel&#40;msh_file_gmsh&#41;</code></pre>
<p>This model contains the mesh and the physical tags of the model, which have been created directly through <code>GMSH</code>. Another option would be to create the model using Gridap, then exporting to <code>.json</code> format in the followig way:</p>
<pre><code class="language-julia">msh_file_json &#61; projectdir&#40;&quot;meshes/elasticity.json&quot;&#41;
to_json_file&#40;model,msh_file_json&#41;</code></pre>
<p>We can then load the saved model</p>
<pre><code class="language-julia">model &#61; DiscreteModelFromFile&#40;msh_file_json&#41;</code></pre>
<p>You can easily inspect the generated discrete model in <a href="https://www.paraview.org/">ParaView</a> by writing it in <code>vtk</code> format.</p>
<pre><code class="language-julia">writevtk&#40;model,datadir&#40;&quot;elasticity_model&quot;&#41;&#41;</code></pre>
<p>The previous line generates four different files <code>model_0.vtu</code>, <code>model_1.vtu</code>, <code>model_2.vtu</code>, and <code>model_3.vtu</code> containing the vertices, edges, faces, and cells present in the discrete model. Moreover, you can easily inspect which boundaries are defined within the model.</p>
<h3 id="exercise_1"><a href="#exercise_1" class="header-anchor">Exercise 1</a></h3>
<p><em>Open the resulting files with ParaView. Visualize the faces of the model and color them by each of the available fields. Identify the field names representing the boundaries \(\Gamma_{\rm B}\) and \(\Gamma_{\rm G}\).</em></p>
<h2 id="set_up_the_vector-valued_fe_space_with_dirichlet_bcs_in_selected_components"><a href="#set_up_the_vector-valued_fe_space_with_dirichlet_bcs_in_selected_components" class="header-anchor">Set up the vector-valued FE space with Dirichlet BCs in selected components</a></h2>
<p>We will construct the vector-valued test FE space as follows:</p>
<pre><code class="language-julia">order &#61; 1
reffe &#61; ReferenceFE&#40;lagrangian,VectorValue&#123;3,Float64&#125;,order&#41;
V0 &#61; TestFESpace&#40;model,reffe;
 conformity&#61;:H1,
 dirichlet_tags&#61;dirichlet_tags,
 dirichlet_masks&#61;dirichlet_masks&#41;</code></pre>
<p>The vector-valued interpolation is selected via the option <code>valuetype&#61;VectorValue&#123;3,Float64&#125;</code>, where we use the type <code>VectorValue&#123;3,Float64&#125;</code>, which is the way Gridap represents vectors of three <code>Float64</code> components.</p>
<p>In the next two exercises, we will fill in</p>
<ol>
<li><p>the <code>dirichlet_tags</code> optional argument to identify the Dirichlet regions, and</p>
</li>
<li><p>the <code>dirichlet_masks</code> optional argument to specify which components of the displacement are constrained.</p>
</li>
</ol>
<p>Let&#39;s go step-by-step.</p>
<h3 id="exercise_2"><a href="#exercise_2" class="header-anchor">Exercise 2</a></h3>
<p><em>Fill in the <code>dirichlet_tags</code> using the tag names identified in <strong>Exercise 2</strong> for \(\Gamma_{\rm B}\) and \(\Gamma_{\rm G}\).</em></p>
<p><strong>Hint:</strong> The general input format of <code>dirichlet_tags</code> is a one-dimensional array of tag name strings <code>&#91;&quot;tag_name_1&quot;,...,&quot;tag_name_n&quot;&#93;</code>.</p>
<pre><code class="language-julia"># Solution for exercise 2</code></pre>
<h3 id="exercise_3"><a href="#exercise_3" class="header-anchor">Exercise 3</a></h3>
<p><em>Fill in the <code>dirichlet_masks</code> to select the displacement components to constrain.</em></p>
<p><strong>Hint:</strong> The general input format of <code>dirichlet_masks</code> is a one-dimensional array with the same length and order as <code>dirichlet_tags</code>. Each entry of <code>dirichlet_masks</code> is a boolean tuple of length the problem dimension <code>D</code>, i.e. <code>&#40;bool_x1,...,bool_xD&#41;</code>. If <code>bool_xi &#61;&#61; true</code>, then the <code>xi</code> component of the displacement is constrained, otherwise it is free. Beware of passing the <code>dirichlet_masks</code> in the same order as the <code>dirichlet_tags</code>.</p>
<p>Recall that we constrain only the first component on the boundary \(\Gamma_{\rm B}\), whereas we constrain all components on \(\Gamma_{\rm G}\).</p>
<pre><code class="language-julia"># Solution for exercise 3</code></pre>
<p>We can now instantiate the vector-valued test FE space.</p>
<pre><code class="language-julia">order &#61; 1
reffe &#61; ReferenceFE&#40;lagrangian,VectorValue&#123;3,Float64&#125;,order&#41;
V0    &#61; TestFESpace&#40;model,reffe;
                    conformity&#61;:H1,
                    dirichlet_tags&#61;dirichlet_tags,
                    dirichlet_masks&#61;dirichlet_masks&#41;</code></pre>
<p>Next, we construct the trial FE space. The Dirichlet boundary conditions must be described with two different functions, one for boundary \(\Gamma_{\rm B}\) and another one for \(\Gamma_{\rm G}\).</p>
<h3 id="exercise_4"><a href="#exercise_4" class="header-anchor">Exercise 4</a></h3>
<p><em>Define the Dirichlet functions according to the problem statement.</em></p>
<p><strong>Hint:</strong> The functions must be vector-valued with the format <code>VectorValue&#40;val_x1,...,val_xD&#41;</code>.</p>
<pre><code class="language-julia"># Solution for exercise 4</code></pre>
<h3 id="exercise_5"><a href="#exercise_5" class="header-anchor">Exercise 5</a></h3>
<p><em>Define the trial FE space <code>U</code>.</em></p>
<p><strong>Hint:</strong> Pass the Dirichlet functions in a one-dimensional array, in the same order as <code>dirichlet_tags</code> and <code>dirichlet_masks</code>.</p>
<pre><code class="language-julia"># Solution for exercise 5</code></pre>
<p>We will now visually check the Dirichlet values are being correctly assigned on the Dirichlet boundaries.</p>
<h3 id="exercise_6"><a href="#exercise_6" class="header-anchor">Exercise 6</a></h3>
<p><em>Create a <code>BoundaryTriangulation</code> of the Dirichlet boundaries.</em></p>
<pre><code class="language-julia"># Solution for exercise 6</code></pre>
<p>Next, we create a FE Function of <code>U</code> with zero-valued free values.</p>
<pre><code class="language-julia">vh &#61; zero&#40;U&#41;</code></pre>
<h3 id="exercise_7"><a href="#exercise_7" class="header-anchor">Exercise 7</a></h3>
<p><em>Plot <code>vh</code> on the Dirichlet boundaries using <code>writevtk</code></em></p>
<pre><code class="language-julia"># Solution for exercise 7</code></pre>
<p>The plot of the x-component of <code>vh</code> should look as follows.</p>
<p><img src="/assets/literate_figures/elasticity/fig_dbc.png" alt="" /></p>
<p><em>Why do the results at the contour of \(\Gamma_{\rm B}\) look weird?</em></p>
<p>The reason is because we are enforcing the Dirichlet values <em>only in the interior</em> of the Dirichlet regions. So, in the contour of \(\Gamma_{\rm B}\) the x-component of the DoF values must be zero. We can use the tag names of the model ending with <code>_c</code> to enforce the Dirichlet conditons on the boundary closure too.</p>
<h2 id="from_weak_form_to_visualising_the_solution"><a href="#from_weak_form_to_visualising_the_solution" class="header-anchor">From weak form to visualising the Solution</a></h2>
<h3 id="exercise_8"><a href="#exercise_8" class="header-anchor">Exercise 8</a></h3>
<p><em>Read the details about how we define weak form, solve the problem and visualise the results.</em></p>
<p>The construction of the weak form needs to account for the constitutive law that relates strain and stress. The symmetric gradient operator is represented by the function <code>ε</code> provided by Gridap &#40;also available as <code>symmetric_gradient</code>&#41;. However, function <code>σ</code> representing the stress tensor is not predefined in the library and it has to be defined ad-hoc by the user, namely</p>
<pre><code class="language-julia">const E &#61; 70.0e9
const ν &#61; 0.33
const λ &#61; &#40;E*ν&#41;/&#40;&#40;1&#43;ν&#41;*&#40;1-2*ν&#41;&#41;
const μ &#61; E/&#40;2*&#40;1&#43;ν&#41;&#41;
σ&#40;ε&#41; &#61; λ*tr&#40;ε&#41;*one&#40;ε&#41; &#43; 2*μ*ε</code></pre>
<p>Function <code>σ</code> takes a strain tensor <code>ε</code> &#40;one can interpret this strain as the strain at an arbitrary integration point&#41; and computes the associated stress tensor using the Lamé operator.</p>
<p>We build now the integration mesh and the corresponding measure</p>
<pre><code class="language-julia">degree &#61; 2*order
Ω      &#61; Triangulation&#40;model&#41;
dΩ     &#61; Measure&#40;Ω,degree&#41;</code></pre>
<p>From these objects and the constitutive law previously defined, we can write the weak form as follows</p>
<pre><code class="language-julia">a&#40;u,v&#41; &#61; ∫&#40; &#40;σ∘ε&#40;u&#41;&#41; ⊙ ε&#40;v&#41; &#41;dΩ
l&#40;v&#41;   &#61; 0</code></pre>
<p>Note that we have composed function <code>σ</code> with the strain field <code>ε&#40;u&#41;</code> in order to compute the stress field associated with the trial function <code>u</code>. The linear form is simply <code>l&#40;v&#41; &#61; 0</code> since there are not external forces in this example.</p>
<p>The remaining steps for solving the FE problem are rather standard.</p>
<pre><code class="language-julia">op &#61; AffineFEOperator&#40;a,l,U,V0&#41;
uh &#61; solve&#40;op&#41;</code></pre>
<p>Finally, we write the results to a file. Note that we also include the strain and stress tensors into the results file.</p>
<pre><code class="language-julia">out_file &#61; datadir&#40;&quot;elasticity_sol&quot;&#41;
writevtk&#40;Ω,out_file,cellfields&#61;&#91;&quot;uh&quot;&#61;&gt;uh,&quot;epsi&quot;&#61;&gt;ε&#40;uh&#41;,&quot;sigma&quot;&#61;&gt;σ∘ε&#40;uh&#41;&#93;&#41;</code></pre>
<p>If you plot the deformed displacement in ParaView, it can be clearly observed &#40;see next figure&#41; that the surface \(\Gamma_{\rm B}\) is pulled in \(x_1\)-direction and that the solid deforms accordingly.</p>
<p><img src="/assets/literate_figures/elasticity/disp_ux_40.png" alt="" /></p>
<h3 id="bonus_exercise"><a href="#bonus_exercise" class="header-anchor">Bonus exercise</a></h3>
<p>Modify this model to solve a multi-material linear elasticity problem as done <a href="https://gridap.github.io/Tutorials/dev/pages/t003_elasticity/#Multi-material-problems-1">here</a>.</p>
<p><strong>Exercise done&#33;</strong></p>
<h2 id="references"><a href="#references" class="header-anchor">References</a></h2>
<p>This exercise is adapted from the <a href="https://gridap.github.io/Tutorials/dev/pages/t003_elasticity/#Tutorial-3:-Linear-elasticity-1">Gridap Tutorial 3: Linear elasticity</a>.</p>

<div class="page-foot">
  <div class="copyright">
    <a href="https://github.com/gridap/GridapWorkshopNCI2023"><b>Edit this page on <img class="github-logo" src="https://unpkg.com/ionicons@5.1.2/dist/svg/logo-github.svg"></img></b></a><br>
    Last modified: November 25, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
    </div>  <!-- div: content container -->
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>
