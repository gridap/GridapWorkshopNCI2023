<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="/libs/lunr/lunr.min.js"></script>
<script src="/libs/lunr/lunr_index.js"></script>
<script src="/libs/lunr/lunrclient.min.js"></script>
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
     
   <link rel="stylesheet" href="/libs/highlight/github.min.css">
   
  <link rel="stylesheet" href="/css/franklin.css">
<link rel="stylesheet" href="/css/poole_hyde.css">
<link rel="stylesheet" href="/css/custom.css">
<!-- style adjustments -->
<style>
  html {font-size: 17px;}
  .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;}
  @media (min-width: 940px) {
    .franklin-content {width: 100%; margin-left: auto; margin-right: auto;}
  }
  @media (max-width: 768px) {
    .franklin-content {padding-left: 6%; padding-right: 6%;}
  }
</style>

<link rel="apple-touch-icon" sizes="152x152" href="/assets/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
<link rel="manifest" href="/assets/favicon/site.webmanifest">
<link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">



   <title>Incompressible Navier-Stokes Tutorial</title>  
</head>
<style>
.content {max-width: 60rem}
</style>
<body>
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <img src="/assets/logos.png" style="width: 500px; height: auto; display: inline">
      <div style="font-weight: margin-bottom: 0.5em"><a href="/">28-29th, November, 2023</a> <span style="opacity: 0.9;">| Australian National University, Canberra</span></div>
      <br>
      <h1><a href="/">Introduction to Gridap: Simulating PDEs using finite elements in Julia</a></h1>
      <div style="line-height:18px; font-size: 15px; opacity: 0.85">by &nbsp; <a href="https://research.monash.edu/en/persons/santiago-badia">Santiago Badia</a>, &nbsp; <a href="https://amartinhuertas.github.io/">Alberto F. Martin</a>, &nbsp; <a href="https://github.com/JordiManyer">Jordi Manyer</a> </div>
    </div>
    <br>
    <style>
    </style>
    <nav class="sidebar-nav" style="opacity: 0.9; margin-bottom: 1.2cm;">
      <a class="sidebar-nav-item " href="/"><b>Welcome</b></a>
      <a class="sidebar-nav-item " href="/venue/"><b>Venue</b></a>
      <a class="sidebar-nav-item " href="/schedule"><b>Schedule</b></a>
      <a class="sidebar-nav-item " href="/software_install/">Software install instructions</a>
      <a class="sidebar-nav-item " href="/tutorials/">Tutorials & Exercises</a>
      <a class="sidebar-nav-item " href="/references/">References</a>
      <a class="sidebar-nav-item " href="/grants/">Registration and
               grants for research students</a>
      <a class="sidebar-nav-item " href="/acks/">Acknowledgements</a>         
      <a class="sidebar-nav-item " href="/flyer/">Event Flyer</a>
      <br>
    </nav>
    <form id="lunrSearchForm" name="lunrSearchForm">
      <input class="search-input" name="q" placeholder="Enter search term" type="text">
      <input type="submit" value="Search" formaction="/search/index.html">
    </form>
    <br>
    <br>
  </div>
</div>
<div class="content container">

<!-- Content appended here -->
<div class="franklin-content">
<h1 id="incompressible_navier-stokes_tutorial"><a href="#incompressible_navier-stokes_tutorial" class="header-anchor">Incompressible Navier-Stokes Tutorial</a></h1>
<h2 id="problem_statement"><a href="#problem_statement" class="header-anchor">Problem statement</a></h2>
<p>The goal is to solve a nonlinear multi-field PDE. As a model problem, we consider a well known benchmark in computational fluid dynamics, the laminar flow around a cyclinder for the incompressible Navier-Stokes equations. We will solve this problem by building on the concepts seen in the previous tutorials.</p>
<p>The computational domain \(\Omega\) is a 2-dimensional channel. The fluid enters the channel from the left boundary &#40;inlet&#41; and exits through the right boundary &#40;outlet&#41;. The channel has a cylindrical obstacle near the inlet. The domain can be seen in the following figure: &lt;div&gt; &lt;img src&#61;&quot;../../assets/literate<em>figures/ins/perforated</em>plate.png&quot; width&#61;&quot;400&quot;/&gt; &lt;/div&gt;</p>
<p>We define \(\partial \Omega = \Gamma_{w} \cup \Gamma_{c} \cup \Gamma_{in} \cup \Gamma_{out}\) with \(\Gamma_{w}\) the top and bottom channel walls, \(\Gamma_{c}\) the cylinder walls, \(\Gamma_{in}\) the inlet and \(\Gamma_{out}\) the outlet.</p>
<p>Formally, the PDE we want to solve is: find the velocity vector \(u\) and the pressure \(p\) such that</p>
\[
\left\lbrace
\begin{aligned}
-\Delta u + \mathit{Re}\ (u\cdot \nabla)\ u + \nabla p = 0 &\text{ in }\Omega,\\
\nabla\cdot u = 0 &\text{ in } \Omega,\\
u = u_{in} &\text{ on } \Gamma_{in},\\
u = 0 &\text{ on } \Gamma_{w} \cup \Gamma_{c},\\
n_\Gamma \cdot \sigma = 0 &\text{ on } \Gamma_{out},\\
\end{aligned}
\right.
\]
<p>where \(d=2\) , and \(\mathit{Re}\) is the Reynolds number.</p>
<p>The inflow condition is given by</p>
\[
u_{in}(0,y) = \left( 4 U_{m} \frac{y(H-y)}{H^2}, 0 \right),
\]
<p>with \(U_{m}=0.3 \ m/s\) the maximum velocity and \(H = 0.41 \ m\) the height of the channel.</p>
<h2 id="numerical_scheme"><a href="#numerical_scheme" class="header-anchor">Numerical Scheme</a></h2>
<p>In order to approximate this problem we chose a formulation based on inf-sup stable \(P_{k}/P_{k-1}\) triangular elements with continuous velocities and pressures. The interpolation spaces are defined as follows. The velocity interpolation space is</p>
\[
V \doteq \{ v \in [H^1(\Omega)]^d:\ v|_T\in [P_k(T)]^d \text{ for all } T\in\mathcal{T} \},
\]
<p>where \(T\) denotes an arbitrary cell of the FE mesh \(\mathcal{T}\), and \(P_k(T)\) is the usual Lagrangian FE space of order \(k\) defined on a mesh of triangles or tetrahedra. On the other hand, the space for the pressure is given by</p>
\[
Q \doteq \{ q \in C^0(\Omega):\ q|_T\in P_{k-1}(T) \text{ for all } T\in\mathcal{T}\}.
\]
<p>The weak form associated to these interpolation spaces reads: find \((u,p)\in U_g \times Q\) such that \([r(u,p)](v,q)=0\) for all \((v,q)\in V_0 \times Q\) where \(U_g\) and \(V_0\) are the set of functions in \(V\) fulfilling the Dirichlet boundary conditions and the homogeneous Dirichlet boundary conditions respetively. The weak residual \(r\) evaluated at a given pair \((u,p)\) is the linear form defined as</p>
\[
[r(u,p)](v,q) \doteq a((u,p),(v,q))+ [c(u)](v),
\]
<p>with</p>
\[
\begin{aligned}
a((u,p),(v,q)) &\doteq \int_{\Omega} \nabla v \cdot \nabla u \ {\rm d}\Omega - \int_{\Omega} (\nabla\cdot v) \ p \ {\rm d}\Omega + \int_{\Omega} q \ (\nabla \cdot u) \ {\rm d}\Omega,\\
[c(u)](v) &\doteq \int_{\Omega} v 	\cdot \left( (u\cdot\nabla)\ u \right)\ {\rm d}\Omega.\\
\end{aligned}
\]
<p>Note that the bilinear form \(a\) is associated with the linear part of the PDE, whereas \(c\) is the contribution to the residual resulting from the convective term.</p>
<p>In order to solve this nonlinear weak equation with a Newton-Raphson method, one needs to compute the Jacobian associated with the residual \(r\). In this case, the Jacobian \(j\) evaluated at a pair \((u,p)\) is the bilinear form defined as</p>
\[
[j(u,p)]((\delta u, \delta p),(v,q)) \doteq a((\delta u,\delta p),(v,q))  + [{\rm d}c(u)](\delta u,v),
\]
<p>where \({\rm d}c\) results from the linearization of the convective term, namely</p>
\[
[{\rm d}c(u)](\delta u,v) \doteq \int_{\Omega} v \cdot \left( (u\cdot\nabla)\ \delta u \right) \ {\rm d}\Omega + \int_{\Omega} v \cdot \left( (\delta u\cdot\nabla)\ u \right)  \ {\rm d}\Omega.
\]
<h2 id="geometry"><a href="#geometry" class="header-anchor">Geometry</a></h2>
<p>We start by importing the packages and loading the provided mesh in the file <code>perforated_plate_tiny.msh</code>:</p>
<pre><code class="language-julia">using Gridap, GridapGmsh
using DrWatson

msh_file &#61; projectdir&#40;&quot;meshes/perforated_plate_tiny.msh&quot;&#41;
model &#61; GmshDiscreteModel&#40;msh_file&#41;</code></pre>
<h3 id="exercise_1"><a href="#exercise_1" class="header-anchor">Exercise 1</a></h3>
<p><em>Open the resulting files with ParaView. Visualize the faces of the model and color them by each of the available fields. Identify the tag names representing the boundaries \(\Gamma_{w}\) &#40;top and bottom channel walls&#41;, \(\Gamma_{c}\) &#40;cylinder walls&#41;, \(\Gamma_{in}\) &#40;inlet&#41; and \(\Gamma_{out}\) &#40;outlet&#41;.</em></p>
<pre><code class="language-julia">writevtk&#40;model,datadir&#40;&quot;perforated_plate&quot;&#41;&#41;</code></pre>
<h2 id="fe_spaces"><a href="#fe_spaces" class="header-anchor">FE Spaces</a></h2>
<h3 id="exercise_2"><a href="#exercise_2" class="header-anchor">Exercise 2</a></h3>
<p><em>Define the test <code>FESpaces</code> for velocity and pressure, as described above. The velocity space should be a vector-valued lagrangian space of order <code>k</code> with appropriate boundary conditions. The pressure space should be an unconstrained lagrangian space of order <code>k-1</code>.</em></p>
<pre><code class="language-julia">D &#61; 2
k &#61; 2</code></pre>
<h3 id="exercise_3"><a href="#exercise_3" class="header-anchor">Exercise 3</a></h3>
<p><em>Define the boundary conditions for velocity. You should define three functions <code>u_in</code>, <code>u_w</code> and <code>u_c</code> representing the prescribed dirichlet values at \(\Gamma_{in}\), \(\Gamma_w\) and \(\Gamma_c\) respectively.</em></p>
<h3 id="exercise_4"><a href="#exercise_4" class="header-anchor">Exercise 4</a></h3>
<p><em>Define the trial and test spaces for the velocity and pressure fields, as well as the corresponding multi-field spaces.</em></p>
<pre><code class="language-julia">#U &#61;
#P &#61;</code></pre>
<pre><code class="language-julia">#Y &#61;
#X &#61;</code></pre>
<h2 id="nonlinear_weak_form_and_fe_operator"><a href="#nonlinear_weak_form_and_fe_operator" class="header-anchor">Nonlinear weak form and FE operator</a></h2>
<p>As usual, we start by defining the triangulations and measures we will need to define the weak form. In this case, we need to define the measure associate with the bulk \(d\Omega\), as well as the measure associated with the outlet boundary \(\Gamma_{out}\).</p>
<pre><code class="language-julia">degree &#61; k
Ω  &#61; Triangulation&#40;model&#41;
dΩ &#61; Measure&#40;Ω,degree&#41;

Γ_out &#61; BoundaryTriangulation&#40;model,tags&#61;&quot;outlet&quot;&#41;
n_Γout &#61; get_normal_vector&#40;Γ_out&#41;
dΓ_out &#61; Measure&#40;Γ_out,degree&#41;</code></pre>
<p>We also define the Reynolds number and functions to represent the convective term and its linearization.</p>
<pre><code class="language-julia">const Re &#61; 20
conv&#40;u,∇u&#41; &#61; Re*&#40;∇u&#39;&#41;⋅u
dconv&#40;du,∇du,u,∇u&#41; &#61; conv&#40;u,∇du&#41;&#43;conv&#40;du,∇u&#41;</code></pre>
<h3 id="exercise_5"><a href="#exercise_5" class="header-anchor">Exercise 5</a></h3>
<p><em>Define the weak form for our problem. You should start by defining the bilinear forms \(a\) and \(c\) and the trilinear form \(dc\). Then use these components to build the residual \(r\) and the jacobian \(j\).</em></p>
<pre><code class="language-julia">#a&#40;&#40;u,p&#41;,&#40;v,q&#41;&#41; &#61;</code></pre>
<pre><code class="language-julia">#c&#40;u,v&#41; &#61;
#dc&#40;u,du,v&#41; &#61;</code></pre>
<pre><code class="language-julia">#res&#40;&#40;u,p&#41;,&#40;v,q&#41;&#41; &#61;
#jac&#40;&#40;u,p&#41;,&#40;du,dp&#41;,&#40;v,q&#41;&#41; &#61;</code></pre>
<p>We can finally define the <code>FEOperator</code> as usual</p>
<pre><code class="language-julia">op &#61; FEOperator&#40;res,jac,X,Y&#41;</code></pre>
<h2 id="solver_and_solution"><a href="#solver_and_solution" class="header-anchor">Solver and solution</a></h2>
<h3 id="exercise_6"><a href="#exercise_6" class="header-anchor">Exercise 6</a></h3>
<p><em>Create a nonlinear Newton-Raphson solver and solve the problem. Print the solutions to a <code>.vtk</code> file and examine the obtained solution.</em></p>
<pre><code class="language-julia">using LineSearches: BackTracking</code></pre>
<h2 id="references"><a href="#references" class="header-anchor">References</a></h2>
<p>This tutorial follows test case 2D-1 from &#40;Schafer,1996&#41;&#91;https://link.springer.com/chapter/10.1007/978-3-322-89849-4_39&#93;</p>

<div class="page-foot">
  <div class="copyright">
    <a href="https://github.com/gridap/GridapWorkshopNCI2023"><b>Edit this page on <img class="github-logo" src="https://unpkg.com/ionicons@5.1.2/dist/svg/logo-github.svg"></img></b></a><br>
    Last modified: November 25, 2023. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div><!-- CONTENT ENDS HERE -->
    </div>  <!-- div: content container -->
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>

    
  </body>
</html>
